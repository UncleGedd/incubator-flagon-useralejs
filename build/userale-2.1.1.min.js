/**
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the "License"); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * @preserved
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).userale={})}(this,function(n){"use strict";var e="2.1.1",i=null;function t(n,o){Object.keys(o).forEach(function(e){var t;"userFromParams"!==e||(t=function(e){e=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),e=window.location.href.match(e);return e&&e[2]?decodeURIComponent(e[2].replace(/\+/g," ")):null}(o[e]))&&(n.userId=t),n[e]=o[e]})}var r=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var o=Array(e),i=0,t=0;t<n;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,i++)o[i]=r[a];return o},a=function(e,t,n){this.name=e,this.version=t,this.os=n,this.type="browser"},o=function(e){this.version=e,this.type="node",this.name="node",this.os=process.platform},s=function(e,t,n,o){this.name=e,this.version=t,this.os=n,this.bot=o,this.type="bot-device"},u=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},l=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},c=/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,d=3,f=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],m=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function p(e){var o,t=""!==(o=e)&&f.reduce(function(e,t){var n=t[0],t=t[1];if(e)return e;t=t.exec(o);return!!t&&[n,t]},!1);if(!t)return null;var n=t[0],i=t[1];if("searchbot"===n)return new u;t=i[1]&&i[1].split(/[._]/).slice(0,3);t?t.length<d&&(t=r(t,function(e){for(var t=[],n=0;n<e;n++)t.push("0");return t}(d-t.length))):t=[];i=t.join("."),t=function(e){for(var t=0,n=m.length;t<n;t++){var o=m[t],i=o[0];if(o[1].exec(e))return i}return null}(e),e=c.exec(e);return e&&e[1]?new s(n,i,t,e[1]):new a(n,i,t)}var h,w,g,v,y,b,S,O,T,W,k,N,I=h?p(h):"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new l:"undefined"!=typeof navigator?p(navigator.userAgent):"undefined"!=typeof process&&process.version?new o(process.version.slice(1)):null,x=null,E=null;function D(e,t){if(!g.on)return!1;var n=null;t&&(n=t(e));t=e.timeStamp&&0<e.timeStamp?g.time(e.timeStamp):Date.now(),t={milli:Math.floor(t),micro:Number((t%1).toFixed(3))},n={target:C(e.target),path:K(e),pageUrl:window.location.href,pageTitle:document.title,pageReferrer:document.referrer,browser:M(),clientTime:t.milli,microTime:t.micro,location:null!=(t=e).pageX?{x:t.pageX,y:t.pageY}:null!=t.clientX?{x:document.documentElement.scrollLeft+t.clientX,y:document.documentElement.scrollTop+t.clientY}:{x:null,y:null},scrnRes:B(),type:e.type,logType:"raw",userAction:!0,details:n,userId:g.userId,toolVersion:g.version,toolName:g.toolName,useraleVersion:g.useraleVersion,sessionID:g.sessionID};return!("function"==typeof x&&!x(n))&&("function"==typeof E&&(n=E(n,e)),w.push(n),!0)}function A(e,t,n){if(!g.on)return!1;var o=null;t&&(o=t());o={pageUrl:window.location.href,pageTitle:document.title,pageReferrer:document.referrer,browser:M(),clientTime:Date.now(),scrnRes:B(),logType:"custom",userAction:n,details:o,userId:g.userId,toolVersion:g.version,toolName:g.toolName,useraleVersion:g.useraleVersion,sessionID:g.sessionID},e=Object.assign(o,e);return!("function"==typeof x&&!x(e))&&("function"==typeof E&&(e=E(e)),w.push(e),!0)}function B(){return{width:window.innerWidth,height:window.innerHeight}}function C(e){return e.localName?e.localName+(e.id?"#"+e.id:"")+(e.className?"."+e.className:""):e.nodeName?e.nodeName+(e.id?"#"+e.id:"")+(e.className?"."+e.className:""):e&&e.document&&e.location&&e.alert&&e.setInterval?"Window":"Unknown"}function K(e){var t=[];if(e.path)t=e.path;else for(var n=e.target;n;)t.push(n),n=n.parentElement;return function(e){var t,n=0,o=[];for(;t=e[n];)o.push(C(t)),++n;return o}(t)}function M(){return{browser:I?I.name:"",version:I?I.version:""}}var V,L=["click","focus","blur","input","change","mouseover","submit"],P=["load","blur","focus"];function R(e){return{clicks:e.detail,ctrl:e.ctrlKey,alt:e.altKey,shift:e.shiftKey,meta:e.metaKey}}function X(n){var e;return W={click:R,dblclick:R,mousedown:R,mouseup:R,focus:null,blur:null,input:(e=n).logDetails?function(e){return{value:e.target.value}}:null,change:e.logDetails?function(e){return{value:e.target.value}}:null,dragstart:null,dragend:null,drag:null,drop:null,keydown:e.logDetails?function(e){return{key:e.keyCode,ctrl:e.ctrlKey,alt:e.altKey,shift:e.shiftKey,meta:e.metaKey}}:null,mouseover:null},k={},N={wheel:function(e){return{x:e.deltaX,y:e.deltaY,z:e.deltaZ}},scroll:function(){return{x:window.scrollX,y:window.scrollY}},resize:function(){return{width:window.outerWidth,height:window.outerHeight}}},V={submit:null},Object.keys(W).forEach(function(t){document.addEventListener(t,function(e){D(e,W[t])},!0)}),L.forEach(function(e){document.addEventListener(e,function(e){!function(e){var t=C(e.target),n=K(e),o=e.type,i=Math.floor(e.timeStamp&&0<e.timeStamp?g.time(e.timeStamp):Date.now());if(null==v&&(v=t,y=o,b=n,S=i,O=0),v!==t||y!==o){if(T={target:v,path:b,pageUrl:window.location.href,pageTitle:document.title,pageReferrer:document.referrer,browser:M(),count:O,duration:i-S,startTime:S,endTime:i,type:y,logType:"interval",targetChange:v!==t,typeChange:y!==o,userAction:!1,userId:g.userId,toolVersion:g.version,toolName:g.toolName,useraleVersion:g.useraleVersion,sessionID:g.sessionID},"function"==typeof x&&!x(T))return;"function"==typeof E&&(T=E(T,e)),w.push(T),v=t,y=o,b=n,S=i,O=0}v==t&&y==o&&(O+=1)}(e)},!0)}),Object.keys(N).forEach(function(t){k[t]=!0,window.addEventListener(t,function(e){k[t]&&(k[t]=!1,D(e,N[t]),setTimeout(function(){k[t]=!0},n.resolution))},!0)}),Object.keys(V).forEach(function(t){document.addEventListener(t,function(e){D(e,W[t])},!0)}),P.forEach(function(e){window.addEventListener(e,function(e){D(e,function(){return{window:!0}})},!0)}),1}var _=null;function j(e,t){var n,o,i,r;null!==_&&clearInterval(_),n=e,o=t,_=setInterval(function(){o.on&&n.length>=o.logCountThreshold&&(!function e(t,n,o){var i=new XMLHttpRequest;var r=JSON.stringify(t);i.open("POST",n.url);n.authHeader&&i.setRequestHeader("Authorization",n.authHeader);i.setRequestHeader("Content-type","application/json;charset=UTF-8");i.onreadystatechange=function(){4===i.readyState&&200!==i.status&&0<o&&e(t,n,o--)};i.send(r)}(n.slice(0),o,0),n.splice(0))},o.transmitInterval),i=e,r=t,document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&0<i.length&&(navigator.sendBeacon(r.url,JSON.stringify(i)),i.splice(0))})}var $,H={},Y=[],F=Date.now();function z(t){n.started||setTimeout(function(){var e=document.readyState;"interactive"===e||"complete"===e?(X(t),j(Y,t),n.started=t.on=!0,A({type:"load",logType:"raw",pageLoadTime:$-F},()=>{},!1)):z(t)},100)}window.onload=function(){$=Date.now()},n.started=!1,H.on=!1,H.useraleVersion=e,t(H,function(){var e,t,n={};null===i&&(e="userAleSessionId",t="session_"+String(Date.now()),i=null!==window.sessionStorage.getItem(e)?JSON.parse(window.sessionStorage.getItem(e)):(window.sessionStorage.setItem(e,JSON.stringify(t)),t));var o=(o=document.currentScript||(o=document.getElementsByTagName("script"))[o.length-1])?o.getAttribute.bind(o):function(){return null};return n.autostart="false"!==o("data-autostart"),n.url=o("data-url")||"http://localhost:8000",n.transmitInterval=+o("data-interval")||5e3,n.logCountThreshold=+o("data-threshold")||5,n.userId=o("data-user")||null,n.version=o("data-version")||null,n.logDetails="true"===o("data-log-details"),n.resolution=+o("data-resolution")||500,n.toolName=o("data-tool")||null,n.userFromParams=o("data-user-from-params")||null,n.time=function(e){{var t,n;t=e.timeStamp&&0<e.timeStamp?(t=Date.now()-e.timeStamp,t<0?function(){return e.timeStamp/1e3}:t>e.timeStamp?(n=performance.timing.navigationStart,function(e){return e+n}):function(e){return e}):function(){return Date.now()}}return t}(document.createEvent("CustomEvent")),n.sessionID=o("data-session")||i,n.authHeader=o("data-auth")||null,n.custIndex=o("data-index")||null,n}()),w=Y,g=H,O=0,T=S=b=y=v=E=x=null,H.autostart&&z(H);n.buildPath=K,n.details=function(e,t){return{click:R,dblclick:R,mousedown:R,mouseup:R,focus:null,blur:null,input:e.logDetails?function(e){return{value:e.target.value}}:null,change:e.logDetails?function(e){return{value:e.target.value}}:null,dragstart:null,dragend:null,drag:null,drop:null,keydown:e.logDetails?function(e){return{key:e.keyCode,ctrl:e.ctrlKey,alt:e.altKey,shift:e.shiftKey,meta:e.metaKey}}:null,mouseover:null,wheel:function(e){return{x:e.deltaX,y:e.deltaY,z:e.deltaZ}},scroll:function(){return{x:window.scrollX,y:window.scrollY}},resize:function(){return{width:window.outerWidth,height:window.outerHeight}},submit:null}[t]},n.filter=function(e){x=e},n.getSelector=C,n.log=function(e){return null!==e&&"object"==typeof e&&(Y.push(e),!0)},n.map=function(e){E=e},n.options=function(e){return void 0!==e&&t(H,e),H},n.packageCustomLog=A,n.packageLog=D,n.start=function(){n.started||z(H),H.on=!0},n.stop=function(){H.on=!1},n.version="2.1.1",Object.defineProperty(n,"__esModule",{value:!0})});